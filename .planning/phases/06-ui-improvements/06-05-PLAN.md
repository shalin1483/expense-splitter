---
phase: 06-ui-improvements
plan: "05"
type: execute
wave: 4
depends_on: ["06-04"]
files_modified:
  - src/components/AssignmentStep.tsx
  - src/components/TaxTipStep.tsx
autonomous: true

must_haves:
  truths:
    - "AssignmentStep renders item cards with Tailwind classes — no old CSS classes (.item-assignment, .person-badge, .custom-split-editor)"
    - "Person badges show clear assigned/unassigned visual states (filled blue vs outline)"
    - "Tip preset buttons show active/inactive visual state (filled brand vs outline)"
    - "TaxTipStep renders with Tailwind classes — no old CSS classes (.tax-tip-step, .tip-preset, .tax-mode)"
    - "Custom split editor is readable with Tailwind classes"
    - "All AssignmentStep and TaxTipStep tests pass"
  artifacts:
    - path: "src/components/AssignmentStep.tsx"
      provides: "AssignmentStep fully migrated to Tailwind"
      contains: "dark:"
    - path: "src/components/TaxTipStep.tsx"
      provides: "TaxTipStep fully migrated to Tailwind"
      contains: "dark:"
  key_links:
    - from: "src/components/AssignmentStep.tsx"
      to: "billStore"
      via: "useAssignments, useBillActions hooks"
      pattern: "useAssignments"
    - from: "src/components/TaxTipStep.tsx"
      to: "billStore"
      via: "useTaxInput, useTipRate, useBillActions"
      pattern: "useTaxInput"
---

<objective>
Migrate AssignmentStep.tsx and TaxTipStep.tsx from plain CSS class names to Tailwind utility classes.

Purpose: These are the most visually complex step components — AssignmentStep has interactive person badges with assigned/unassigned states and an inline custom split editor; TaxTipStep has radio buttons, preset tip buttons, and conditional input rendering. Getting them right here ensures the app's core interaction patterns look polished in both light and dark mode.

Output: AssignmentStep.tsx and TaxTipStep.tsx both fully Tailwind-styled, zero old BEM class dependencies.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-ui-improvements/06-RESEARCH.md
@.planning/phases/06-ui-improvements/06-04-SUMMARY.md
@src/components/AssignmentStep.tsx
@src/components/TaxTipStep.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate AssignmentStep to Tailwind</name>
  <files>src/components/AssignmentStep.tsx</files>
  <action>
Read the current AssignmentStep.tsx fully, then rewrite JSX with Tailwind utility classes. Preserve ALL logic unchanged. Only change className strings and wrapper div structure as needed.

CSS mapping to apply:

Item card wrapper (`.item-assignment`):
`mb-3 p-3 border border-zinc-200 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-900`

Item header row (`.item-header`):
`flex justify-between items-center mb-2`

Item name (`.item-name`):
`font-medium text-zinc-900 dark:text-zinc-50`

Item price in header:
`text-sm font-mono tabular-nums text-zinc-600 dark:text-zinc-400`

Person badges container (`.person-badges`):
`flex flex-wrap gap-2 mt-2`

Person badge — UNASSIGNED state (`.person-badge` without `.assigned`):
`px-4 py-2 rounded-full text-sm min-h-[44px] border-2 border-brand bg-white dark:bg-zinc-900 text-brand hover:bg-brand-light dark:hover:bg-zinc-800 cursor-pointer flex items-center transition-colors active:scale-95`

Person badge — ASSIGNED state (`.person-badge.assigned`):
Add `bg-brand text-white hover:bg-brand-hover` replacing the outline styles — implement with ternary:
```tsx
className={`px-4 py-2 rounded-full text-sm min-h-[44px] border-2 border-brand cursor-pointer flex items-center transition-colors active:scale-95 ${
  isAssigned
    ? 'bg-brand text-white hover:bg-brand-hover'
    : 'bg-white dark:bg-zinc-900 text-brand hover:bg-brand-light dark:hover:bg-zinc-800'
}`}
```

Assignment summary (`.assignment-summary`):
`text-sm text-zinc-500 dark:text-zinc-400 mt-3 flex items-center gap-2 flex-wrap`

Split info (`.split-info`):
`text-sm text-zinc-500 dark:text-zinc-400`

Split info custom variant (`.split-info.custom`):
`text-sm text-brand font-medium`

Custom/Revert buttons (`.custom-split-btn`, `.revert-btn`):
`text-sm px-3 py-1.5 min-h-[32px] rounded-md bg-zinc-100 dark:bg-zinc-800 text-zinc-700 dark:text-zinc-300 hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors`

Custom split section wrapper:
`mt-2`

Custom split editor container (`.custom-split-editor`):
`mt-3 p-3 bg-zinc-50 dark:bg-zinc-800 rounded-md`

Editor title (`.editor-title`):
`text-base font-medium mb-3 text-zinc-900 dark:text-zinc-50`

Split input row (`.split-input-row`):
`flex justify-between items-center mb-2`

Person label (`.person-label`):
`flex-1 text-sm text-zinc-700 dark:text-zinc-300`

Percentage input group (`.percentage-input-group`):
`flex items-center gap-1`

Percentage input (`.percentage-input`):
`w-[70px] px-2 py-1.5 text-sm border border-zinc-300 dark:border-zinc-600 rounded-md min-h-[36px] bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-50 focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent`

Percentage symbol (`.percentage-symbol`):
`text-sm text-zinc-500 dark:text-zinc-400`

Split total — VALID state (`.split-total.valid`):
`mt-3 mb-3 font-medium text-center p-2 rounded-md text-success bg-success-light dark:bg-success/10`

Split total — INVALID state (`.split-total.invalid`):
`mt-3 mb-3 font-medium text-center p-2 rounded-md text-danger bg-danger-light dark:bg-danger/10`

Implement with ternary:
```tsx
className={`mt-3 mb-3 font-medium text-center p-2 rounded-md ${
  isValid
    ? 'text-success bg-success-light dark:bg-success/10'
    : 'text-danger bg-danger-light dark:bg-danger/10'
}`}
```

Editor actions row (`.editor-actions`):
`flex gap-2 justify-end`

Cancel/Save buttons (`.cancel-btn`, `.save-btn`):
- Cancel: `min-w-[80px] px-4 py-2 rounded-md bg-zinc-100 dark:bg-zinc-800 text-zinc-700 dark:text-zinc-300 hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors`
- Save: `min-w-[80px] px-4 py-2 rounded-md bg-brand text-white hover:bg-brand-hover disabled:opacity-40 disabled:cursor-not-allowed transition-colors`
  </action>
  <verify>
Run: `npx vitest run src/components/AssignmentStep.test.tsx 2>&1 | tail -20`
Expected: All AssignmentStep tests pass.
Run: `grep -E "className=\"[^\"]*item-assignment|className=\"[^\"]*person-badge|className=\"[^\"]*custom-split" src/components/AssignmentStep.tsx`
Expected: No matches (old CSS class names removed).
  </verify>
  <done>AssignmentStep.tsx uses only Tailwind classes. canProceedFromAssignment still exported. All AssignmentStep tests pass.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate TaxTipStep to Tailwind</name>
  <files>src/components/TaxTipStep.tsx</files>
  <action>
Read the current TaxTipStep.tsx fully, then rewrite JSX with Tailwind utility classes. Preserve ALL logic unchanged.

CSS mapping to apply:

Outer wrapper (`.tax-tip-step`):
No wrapper needed — or just `<div>` with no class.

Section elements (`.tax-tip-step section`):
`mb-6` (margin-bottom on each section)

Section headings (`h3`):
`text-base font-semibold mb-3 text-zinc-800 dark:text-zinc-200`

Tax mode radio group (`.tax-mode`):
`flex gap-6 mb-3`

Tax mode label:
`flex items-center gap-1.5 text-[0.9375rem] text-zinc-700 dark:text-zinc-300 cursor-pointer`

Tax input row (`.tax-input-row`):
`flex items-center gap-2`

Tax/tip input fields:
`w-[100px] px-3 py-2 text-base border border-zinc-300 dark:border-zinc-600 rounded-md min-h-[44px] bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-50 focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent`

Input suffix ($, %) (`.input-suffix`):
`text-sm text-zinc-500 dark:text-zinc-400`

No Tax button (`.no-tax-btn`):
`px-3 py-2 ml-2 text-sm border border-zinc-300 dark:border-zinc-600 rounded-md bg-transparent text-zinc-500 dark:text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-800 min-h-[44px] transition-colors`

Tax preview (`.tax-preview`) and tip preview (`.tip-preview`):
`text-sm text-zinc-500 dark:text-zinc-400 mt-2`

Tip presets container (`.tip-presets`):
`flex gap-2 mb-3`

Tip preset button — INACTIVE (`.tip-preset` without `.active`):
`flex-1 py-3 text-base border-2 border-brand rounded-lg bg-white dark:bg-zinc-900 text-brand hover:bg-brand-light dark:hover:bg-zinc-800 min-h-[44px] cursor-pointer text-center transition-colors`

Tip preset button — ACTIVE (`.tip-preset.active`):
`bg-brand text-white hover:bg-brand-hover`

Implement with ternary:
```tsx
className={`flex-1 py-3 text-base border-2 border-brand rounded-lg min-h-[44px] cursor-pointer text-center transition-colors ${
  activeTipPreset(rate)
    ? 'bg-brand text-white hover:bg-brand-hover'
    : 'bg-white dark:bg-zinc-900 text-brand hover:bg-brand-light dark:hover:bg-zinc-800'
}`}
```

Tip input row (`.tip-input-row`):
`flex items-center gap-2`

Custom tip label:
`text-sm text-zinc-700 dark:text-zinc-300`
  </action>
  <verify>
Run: `npx vitest run src/components/TaxTipStep.test.tsx 2>&1 | tail -20`
Expected: All TaxTipStep tests pass.
Run: `grep -E "className=\"[^\"]*tax-tip-step|className=\"[^\"]*tip-preset|className=\"[^\"]*tax-mode" src/components/TaxTipStep.tsx`
Expected: No matches (old CSS class names removed).
  </verify>
  <done>TaxTipStep.tsx uses only Tailwind classes. All TaxTipStep tests pass.</done>
</task>

</tasks>

<verification>
1. `npx vitest run src/components/AssignmentStep.test.tsx src/components/TaxTipStep.test.tsx` — all tests pass
2. `npm run build` exits 0
3. `grep "item-assignment\|person-badge\|custom-split-editor\|tip-preset\|tax-tip-step\|tax-mode" src/components/AssignmentStep.tsx src/components/TaxTipStep.tsx` — no matches
4. Both files contain `dark:` variant classes
</verification>

<success_criteria>
- AssignmentStep.tsx: zero old CSS class dependencies, person badge assigned/unassigned states implemented as Tailwind ternary, custom split editor styled, dark: variants present, canProceedFromAssignment exported, all tests pass
- TaxTipStep.tsx: zero old CSS class dependencies, tip preset active/inactive as Tailwind ternary, dark: variants present, all tests pass
- npm run build exits 0
</success_criteria>

<output>
After completion, create `.planning/phases/06-ui-improvements/06-05-SUMMARY.md` following the summary template.
</output>
